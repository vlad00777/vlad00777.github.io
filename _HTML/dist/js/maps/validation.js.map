{"version":3,"sources":["validation.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"validation.js","sourcesContent":["/*\n    validation.js v2.0\n    Wezom wTPL v4.0.0\n*/\n\n(function($){\n\n    if (typeof wHTML === 'undefined') {\n        window.wHTML = {};\n    }\n\n    var ValidLang = wLocalize.Validate[wLang];\n    var MSGS = {};\n    for (var key in ValidLang) {\n        var val = ValidLang[key];\n        switch(key) {\n            case 'maxlength':\n            case 'maxlength_checker':\n            case 'maxlength_select':\n            case 'minlength':\n            case 'minlength_select':\n            case 'minlength_checker':\n            case 'rangelength':\n            case 'rangelength_checker':\n            case 'rangelength_select':\n            case 'rangelength_select':\n            case 'range':\n            case 'max':\n            case 'min':\n            case 'filetype':\n            case 'filesize':\n            case 'filesizeEach':\n            case 'pattern':\n                MSGS[key] = $.validator.format(val);\n                break;\n            default:\n                MSGS[key] = val;\n        }\n    }\n\n    $.extend($.validator.messages, MSGS);\n\n    wHTML.wInputDate = function() {\n        if (!Modernizr.touch) {\n            var dates = document.getElementsByClassName('wInputDate');\n            for (var i = 0; i < dates.length; i++) {\n                var el = dates[i];\n                if (el.type == 'date') {\n                    el.type = 'text';\n                }\n            }\n        }\n    };\n\n    wHTML.validation = function() {\n        this.wInputDate();\n        $('.wForm').each(function() {\n            var formValid = $(this);\n            var validator = $.data(this, \"validator\");\n            if (typeof validator === 'undefined') {\n                formValid.validate({\n                    showErrors: function(errorMap, errorList) {\n                        if (errorList.length) {\n                            var firstError = errorList.shift();\n                            var newErrorList = [];\n                            newErrorList.push(firstError);\n                            this.errorList = newErrorList;\n                        }\n                        this.defaultShowErrors();\n                    },\n                    invalidHandler: function(form, validator) {\n                        formValid\n                            .addClass('no_valid')\n                            .data('validator').focusInvalid();\n                    },\n                    submitHandler: function(form) {\n                        var formJQ = $(form);\n                        var preloader = false;\n                        if (formJQ.hasClass('wFormPreloader')) {\n                            preloader = formJQ;\n                        } else if (formJQ.hasClass('wSubmitPreloader')) {\n                            preloader = formJQ.find('.wSubmit');\n                        }\n                        formValid.removeClass('no_valid').addClass('success');\n                        if (form.tagName.toLowerCase() === 'form') {\n                            form.submit();\n                        } else {\n                            if (preloader) {\n                                wPreloader.show(preloader);\n                            }\n                            if( formJQ.data('ajax') ) {\n                                var data = new FormData();\n                                var name;\n                                var val;\n                                var type;\n                                formJQ.find('input,textarea,select').each(function(){\n                                    var thisJQ = $(this);\n                                    name = thisJQ.data('name');\n                                    val = this.value;\n                                    type = this.type;\n                                    if((type != 'checkbox' && name) || (type == 'checkbox' && this.checked && name)) {\n                                        if(type == 'file') {\n                                            data.append(name, $(this)[0].files[0]);\n                                        } else if(type == 'radio' && $(this).prop('checked')) {\n                                            data.append(name, val);\n                                        } else if(type != 'radio') {\n                                            data.append(name, val);\n                                        }\n                                    }\n                                });\n                                var request = new XMLHttpRequest();\n                                request.open(\"POST\", '/form/' + formJQ.data('ajax'));\n                                request.onreadystatechange = function() {\n                                    var status;\n                                    var resp;\n                                    if (request.readyState == 4) {\n                                        status = request.status;\n                                        resp = request.response;\n                                        resp = jQuery.parseJSON(resp);\n                                        if (status == 200) {\n                                            if( resp.success ) {\n                                                if (!resp.noclear) {\n                                                    formJQ.validReset();\n                                                }\n                                                if (resp.clear) {\n                                                    for(var i = 0; i < resp.clear.length; i++) {\n                                                        $('input[name=\"' + resp.clear[i] + '\"]').val('');\n                                                        $('textarea[name=\"' + resp.clear[i] + '\"]').val('');\n                                                    }\n                                                }\n                                                if (resp.insert && resp.insert.selector && resp.insert.html) {\n                                                    $(resp.insert.selector).html(resp.insert.html);\n                                                }\n                                                if ( resp.response ) {\n                                                    generate(resp.response, 'success', 3500);\n                                                }\n                                            } else {\n                                                if ( resp.response ) {\n                                                    generate(resp.response, 'warning', 3500);\n                                                }\n                                            }\n                                            if( resp.redirect ) {\n                                                if(window.location.href == resp.redirect) {\n                                                    window.location.reload();\n                                                } else {\n                                                    window.location.href = resp.redirect;\n                                                }\n                                            }\n                                        } else {\n                                            alert('Something went wrong,\\nbut HTML fine ;)');\n                                        }\n                                    }\n                                    if (preloader) {\n                                        wPreloader.hide(preloader);\n                                    }\n                                };\n                                request.send(data);\n                                return false;\n                            } else {\n                                console.warn('HTML => Форма отправлена');\n                                if (preloader) {\n                                    setTimeout(function() {\n                                        formJQ.validReset();\n                                        wPreloader.hide(preloader);\n                                    }, 1000);\n                                }\n                            }\n                        }\n                    }\n                });\n                formValid.on('change', '.wFile', function(event) {\n                    formValid.wFileVal(this);\n                });\n\n                /* Без тега FORM */\n                formValid.on('click', '.wSubmit', function(event) {\n                    formValid.submit();\n                });\n\n                /* Сброс Без тега FORM */\n                formValid.on('click', '.wReset', function(event) {\n                    if (formValid.is('DIV')) {\n                        formValid.validReset();\n                        wHTML.wInputDate();\n                    }\n                });\n            }\n        });\n\n    };\n\n})(jQuery);"],"sourceRoot":"/source/"}